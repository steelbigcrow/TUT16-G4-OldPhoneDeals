<form [formGroup]="phoneForm" (ngSubmit)="onSubmit()" novalidate>
  <!-- Title Field -->
  <div class="mb-3">
    <label for="title" class="form-label">Title <span class="text-danger">*</span></label>
    <input type="text" id="title" class="form-control" formControlName="title"
           [ngClass]="{ 'is-invalid': title?.invalid && (title?.dirty || title?.touched) }">
    <div *ngIf="title?.invalid && (title?.dirty || title?.touched)" class="invalid-feedback">
      <div *ngIf="title?.errors?.['required']">Title is required.</div>
      <div *ngIf="title?.errors?.['maxlength']">Title cannot exceed 100 characters.</div>
    </div>
  </div>

  <!-- Brand Field -->
  <div class="mb-3">
    <label for="brand" class="form-label">Brand <span class="text-danger">*</span></label>
    <select id="brand" class="form-select" formControlName="brand"
            [ngClass]="{ 'is-invalid': brand?.invalid && (brand?.dirty || brand?.touched) }">
      <option value="" disabled selected>Select a brand...</option>
      <option *ngFor="let b of brands" [value]="b">{{ b }}</option>
    </select>
    <div *ngIf="brand?.invalid && (brand?.dirty || brand?.touched)" class="invalid-feedback">
      <div *ngIf="brand?.errors?.['required']">Brand is required.</div>
    </div>
  </div>

  <!-- Image URL/Filename Field -->
  <div class="mb-3">
    <label for="image" class="form-label">Image URL or Filename <span class="text-danger">*</span></label>
    <input type="text" id="image" class="form-control" formControlName="image"
           placeholder="e.g., https://example.com/image.jpg or Samsung.jpeg"
           [ngClass]="{ 'is-invalid': image?.invalid && (image?.dirty || image?.touched) }">
    <small class="form-text text-muted">Enter a valid image URL or one of the provided filenames (e.g., Apple.jpeg).</small>
    <div *ngIf="image?.invalid && (image?.dirty || image?.touched)" class="invalid-feedback">
      <div *ngIf="image?.errors?.['required']">Image URL or filename is required.</div>
      <div *ngIf="image?.errors?.['pattern']">Must be a valid URL or a filename ending with .jpeg, .jpg, .png, .gif, or .bmp.</div>
    </div>
  </div>

  <!-- Stock Field -->
  <div class="mb-3">
    <label for="stock" class="form-label">Stock <span class="text-danger">*</span></label>
    <input type="number" id="stock" class="form-control" formControlName="stock" min="0" step="1"
           [ngClass]="{ 'is-invalid': stock?.invalid && (stock?.dirty || stock?.touched) }">
    <div *ngIf="stock?.invalid && (stock?.dirty || stock?.touched)" class="invalid-feedback">
      <div *ngIf="stock?.errors?.['required']">Stock quantity is required.</div>
      <div *ngIf="stock?.errors?.['min']">Stock cannot be negative.</div>
      <div *ngIf="stock?.errors?.['pattern']">Stock must be a whole number (no decimals).</div>
    </div>
  </div>

  <!-- Price Field -->
  <div class="mb-3">
    <label for="price" class="form-label">Price <span class="text-danger">*</span></label>
    <div class="input-group">
       <span class="input-group-text">$</span>
       <input type="number" id="price" class="form-control" formControlName="price" min="0.01" step="0.01"
              [ngClass]="{ 'is-invalid': price?.invalid && (price?.dirty || price?.touched) }">
       <div *ngIf="price?.invalid && (price?.dirty || price?.touched)" class="invalid-feedback"> <!-- Needs d-block if not inside input-group -->
          <div *ngIf="price?.errors?.['required']">Price is required.</div>
          <div *ngIf="price?.errors?.['min']">Price must be at least $0.01.</div>
       </div>
    </div>
     <!-- Display feedback outside the input-group for proper rendering -->
     <div *ngIf="price?.invalid && (price?.dirty || price?.touched)" class="invalid-feedback d-block">
        <span *ngIf="price?.errors?.['required']">Price is required.</span>
        <span *ngIf="price?.errors?.['min']">Price must be at least $0.01.</span>
     </div>
  </div>

   <!-- isDisabled Checkbox -->
   <div class="mb-3 form-check">
        <input type="checkbox" id="isDisabled" class="form-check-input" formControlName="isDisabled"
               [ngClass]="{ 'is-invalid': isDisabled?.invalid && (isDisabled?.dirty || isDisabled?.touched) }">
        <label class="form-check-label" for="isDisabled">Disable Listing</label>
         <!-- Required validator doesn't make sense for boolean, remove error message -->
        <small class="form-text text-muted d-block">Check this box to hide the listing from general search results and homepage sections.</small>
   </div>


  <!-- Action Buttons -->
  <div class="d-flex justify-content-end gap-2 mt-4">
     <button *ngIf="showCancelButton" type="button" class="btn btn-secondary" (click)="onCancel()">
       {{ cancelButtonText }}
     </button>
     <button type="submit" class="btn btn-primary" [disabled]="phoneForm.invalid">
       {{ submitButtonText }}
     </button>
  </div>
</form>
